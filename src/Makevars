CXX_STD = CXX17
PKG_CPPFLAGS = -Ilibcmaes/include -Ilibcmaes/build/include -I../inst/include
PKG_CXXFLAGS += -Wno-unknown-pragmas

LIBCMAES = libcmaes/build/src/libcmaes.a
#PKG_LIBS = libcmaes/build/src/libcmaes.a $(SHLIB_OPENMP_CXXFLAGS) $(SHLIB_OPENMP_LDFLAGS)
PKG_LIBS = $(LIBCMAES)


$(SHLIB): $(PKG_LIBS)

$(LIBCMAES):
	(cd libcmaes; \
	  CXX="$(firstword $(CXX))" \
	  cmake -S . -B build \
	    -DCMAKE_CXX_STANDARD=17 \
	    -DCMAKE_POSITION_INDEPENDENT_CODE=ON \
	    -DLIBCMAES_BUILD_SHARED_LIBS=OFF \
	    -DLIBCMAES_BUILD_PYTHON=OFF \
	    -DLIBCMAES_BUILD_EXAMPLES=OFF \
	    -DLIBCMAES_ENABLE_SURROG=OFF \
	    -DLIBCMAES_USE_OPENMP=OFF \
	    -DCMAKE_BUILD_TYPE=Release \
	    -DCMAKE_CXX_FLAGS=-Wno-unknown-pragmas; \
	  $(MAKE) -C build)

$(OBJECTS): | $(LIBCMAES)



